name: Infrastructure

on: push

jobs:
  app_service:
    name: Deploy Azure App Service
    runs-on: ubuntu-latest
    steps:

        # Checkout code
      - uses: actions/checkout@main

        # Log into Azure
      # - uses: azure/login@v1
      #   with:
      #     creds: ${{ secrets.AZURE_CREDENTIALS }}

        # Deploy Bicep file
      # - name: deploy
      #   uses: azure/arm-deploy@v1
      #   with:
      #     scope: resourceGroup
      #     resourceGroupName: rg-captoso
      #     template: ./app-service.bicep
      #     parameters: ./app-service.parameters.json
      #     failOnStdErr: false
        
      - name: Configure GoDaddy DNS
        env:
          GO_DADDY_SSO_KEY: MYKEY
          GO_DADDY_SSO_SECRET: MYSECRETS
        shell: pwsh
        run: ./configure-godaddy-dns.ps1
